---
name: python-venv-check
description: 在執行 Python 開發或測試前，先檢查專案根目錄是否已有 .venv；若存在則直接使用，不存在才詢問使用者要建立虛擬環境或改用系統預設環境。
---

# Python 虛擬環境檢查流程（.venv 優先）

此技能用於標準化 Python 環境啟用流程，避免重複建立虛擬環境，並遵循「先用現有、再詢問」原則。

## 適用情境

- 需要執行 Python 指令、測試或安裝套件前
- 專案可能已經有既存 `.venv`
- 需要在建立新環境前先與使用者確認，若已經有確認有 `.venv` 環境則直接使用

## 核心原則

1. 先檢查專案根目錄是否存在 `.venv`
2. 若 `.venv` 存在：直接使用該環境，不建立新的虛擬環境
3. 若 `.venv` 不存在：先詢問使用者
   - 是否要建立新的虛擬環境
   - 或改用系統預設 Python 環境
4. 未取得使用者明確選擇前，不主動建立新虛擬環境

## 標準流程

### 步驟 1：檢查 `.venv` 是否存在

以目前專案根目錄為準檢查 `.venv` 目錄。

### 步驟 2：若存在 `.venv`

- 視為首選 Python 執行環境
- 後續 Python 指令與套件安裝都應使用此環境
- 不再詢問是否建立新環境（除非使用者主動要求）

### 步驟 3：若不存在 `.venv`

向使用者提出二選一：

- 建立新的虛擬環境（例如 `.venv`）
- 使用系統預設 Python 環境

範例詢問句：

「目前在專案根目錄找不到 `.venv`。你希望我現在建立一個新的虛擬環境，還是改用系統預設 Python 環境？」

## 實作提醒

- 以專案根目錄為唯一判斷基準，避免在子目錄重複建立環境
- 若已存在 `.venv`，不要覆寫或重建
- 記錄使用者選擇並在同一工作流程中保持一致
- 若使用者後續改變選擇，再切換環境策略

## 完成條件

- 已完成 `.venv` 存在性檢查
- 已採用既有 `.venv` 或取得使用者明確選擇
- 後續操作（安裝、測試、執行）皆使用一致的 Python 環境
